import{s as p,C as l,o as f}from"../chunks/scheduler.e427dfb5.js";import{S as u,i as g}from"../chunks/index.51bba90f.js";import{p as h}from"../chunks/stores.14b5174e.js";import{j as k}from"../chunks/singletons.4d73db2a.js";import{d as T}from"../chunks/dayjs.min.a0a66fd6.js";import{m as d,a as S}from"../chunks/hooks.client.16043796.js";const c=k("goto");function y(t,n,i){let s;return l(t,h,o=>i(0,s=o)),f(async()=>{const o=s.url.searchParams.get("code"),m=localStorage.getItem("code_verifier")??"";await fetch("/login/callback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:o,codeVerifier:m})}).then(e=>e.json()).then(e=>{if(e!=null&&e.error){c("/login/error");return}const r=T().valueOf(),a={accessToken:{token:e.accessToken??"",timestamp:r},refreshToken:{token:e.refreshToken??"",timestamp:r}};d(a),S.set(a),c("/home")})}),[]}class P extends u{constructor(n){super(),g(this,n,y,null,p,{})}}export{P as component};
