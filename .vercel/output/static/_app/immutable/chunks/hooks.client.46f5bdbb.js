import{w as s}from"./index.b6f5b428.js";import{a as i}from"./dayjs.min.a35c91f3.js";const d=s(null),S=s(null),g=s(null),n=e=>{let t="";const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let a=0;a<e;a++)t+=o.charAt(Math.floor(Math.random()*o.length));return t},m=async e=>{function t(l){return btoa(String.fromCharCode.apply(null,new Uint8Array(l))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}const a=new TextEncoder().encode(e),c=await window.crypto.subtle.digest("SHA-256",a);return t(c)},h=()=>{const e="3d769c375f754b6c9ba2c74606b34397",t="https://sveltify-dev.vercel.app/login/callback",o=n(128);m(o).then(a=>{const c=n(16);localStorage.setItem("code_verifier",o);const l=new URLSearchParams({response_type:"code",client_id:e,scope:"user-read-email user-read-private user-top-read",redirect_uri:t,state:c,code_challenge_method:"S256",code_challenge:a});window.location.href="https://accounts.spotify.com/authorize?"+l})},r=s(!1),u=()=>{const e=document.querySelector("html");e&&e.classList.toggle("dark")},y=()=>{r.update(e=>!e),u()},_=()=>{localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.add("dark"),r.set(!0)):(document.documentElement.classList.remove("dark"),r.set(!1)),r.subscribe(e=>{localStorage.setItem("theme",e?"dark":"light")})},b=()=>{const e=JSON.parse(localStorage.getItem("access_token")??"{}"),t=JSON.parse(localStorage.getItem("refresh_token")??"{}");return e!=null&&e.token&&(t!=null&&t.token)&&g.set({accessToken:e,refreshToken:t}),null},w=e=>{localStorage.setItem("access_token",JSON.stringify(e==null?void 0:e.accessToken)),localStorage.setItem("refresh_token",JSON.stringify(e==null?void 0:e.refreshToken))},k=()=>{const e=JSON.parse(localStorage.getItem("user_profile")??"{}");return e&&e.display_name&&d.set({...e,timestamp:i().valueOf()}),null},I=e=>{localStorage.setItem("user_profile",JSON.stringify(e))};export{g as a,b,k as c,r as d,d as e,I as f,S as g,h,_ as i,y as t,w as u};
