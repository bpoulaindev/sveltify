import{w as s}from"./index.3afa8ada.js";import{d as l}from"./dayjs.min.a0a66fd6.js";const d=s(null),g=s(null),u=s(null),m=s(null),i=e=>{let t="";const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let r=0;r<e;r++)t+=a.charAt(Math.floor(Math.random()*a.length));return t},p=async e=>{function t(c){return btoa(String.fromCharCode.apply(null,new Uint8Array(c))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}const r=new TextEncoder().encode(e),n=await window.crypto.subtle.digest("SHA-256",r);return t(n)},k=()=>{const e="3d769c375f754b6c9ba2c74606b34397",t="https://sveltify-dev.vercel.app/login/callback",a=i(128);p(a).then(r=>{const n=i(16);localStorage.setItem("code_verifier",a);const c=new URLSearchParams({response_type:"code",client_id:e,scope:"user-read-email user-read-private user-top-read streaming user-library-read user-read-playback-state user-modify-playback-state user-read-currently-playing",redirect_uri:t,state:n,code_challenge_method:"S256",code_challenge:r});window.location.href="https://accounts.spotify.com/authorize?"+c})},o=s(!1),S=()=>{const e=document.querySelector("html");e&&e.classList.toggle("dark")},y=()=>{o.update(e=>!e),S()},_=()=>{localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.add("dark"),o.set(!0)):(document.documentElement.classList.remove("dark"),o.set(!1)),o.subscribe(e=>{localStorage.setItem("theme",e?"dark":"light")})},b=()=>{const e=JSON.parse(localStorage.getItem("access_token")??"{}"),t=JSON.parse(localStorage.getItem("refresh_token")??"{}");return e!=null&&e.token&&(t!=null&&t.token)&&m.set({accessToken:e,refreshToken:t}),null},I=e=>{localStorage.setItem("access_token",JSON.stringify(e==null?void 0:e.accessToken)),localStorage.setItem("refresh_token",JSON.stringify(e==null?void 0:e.refreshToken))},O=()=>{const e=JSON.parse(localStorage.getItem("user_card")??"{}");return e&&e.display_name&&d.set({...e,timestamp:l().valueOf()}),null},w=e=>{localStorage.setItem("user_card",JSON.stringify(e))},J=()=>{const e=JSON.parse(localStorage.getItem("artists_ranking")??"{}");return e&&(e==null?void 0:e.total)>0&&g.set({...e,timestamp:l().valueOf()}),null},N=e=>{localStorage.setItem("artists_ranking",JSON.stringify(e))},v=()=>{const e=JSON.parse(localStorage.getItem("tracks_ranking")??"{}");return e&&(e==null?void 0:e.total)>0&&u.set({...e,timestamp:l().valueOf()}),null},L=e=>{localStorage.setItem("tracks_ranking",JSON.stringify(e))};export{m as a,b,O as c,o as d,w as e,g as f,J as g,N as h,_ as i,u as j,v as k,L as l,I as m,k as n,y as t,d as u};
